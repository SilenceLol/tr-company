<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NORD WHEEL - –ó–∞–º–µ—Ä –≥—Ä—É–∑–æ–≤</title>
    <link rel="stylesheet" href="styles.css">
    <script src="auth-simple.js"></script>
    <style>
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è */
        html, body {
            height: 100%;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: white;
        }
        
        main {
            flex: 1;
            overflow: hidden;
            min-height: 0;
        }
        
        .app-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 5px;
        }
        
        .main-layout {
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        @media (min-width: 480px) {
            .main-layout {
                flex-direction: row;
            }
        }
        
        /* –£–ª—É—á—à–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–∞–ø–∞ */
        .btn-save-mini, .btn-send-mini, .cargo-type-column, 
        .control-btn-mini, .remove-cargo, .btn-secondary {
            min-height: 44px;
            touch-action: manipulation;
        }
        
        /* –£–ª—É—á—à–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤–µ—Å–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        .weight-input {
            font-size: 18px !important;
            height: 40px !important;
        }
        
        /* –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤ */
        @media (max-height: 600px) {
            .employee-info {
                padding: 5px 10px;
            }
            
            .app-container h1 {
                margin: 5px 0;
                font-size: 1.1em;
            }
            
            .cargo-type-column {
                padding: 6px 4px;
                min-height: 35px;
            }
            
            .photo-container-mini {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="logonwnew.png" alt="NORD WHEEL" class="logo-image" onerror="this.style.display='none'">
                <span class="logo-text">NORD WHEEL</span>
            </div>
        </header>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ -->
        <div class="employee-info">
            <div class="employee-details">
                <span id="employeeName">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <button class="btn-logout" onclick="logout()">–í—ã–π—Ç–∏</button>
        </div>

        <main>
            <div class="app-container">
                <h1>–ó–∞–º–µ—Ä –≥—Ä—É–∑–æ–≤</h1>
                
                <div class="main-layout">
                    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - —Ç–∏–ø—ã –≥—Ä—É–∑–æ–≤ -->
                    <div class="left-column">
                        <div class="cargo-types-column">
                            <div class="cargo-type-column" data-type="euro-pallet">
                                <div class="cargo-image-placeholder">
                                    <img src="–ø–∞–ª–ª–µ—Ç.jpg" alt="–ï–≤—Ä–æ–ø–∞–ª–ª–µ—Ç" class="cargo-image">
                                </div>
                                <span>–ï–≤—Ä–æ–ø–∞–ª–ª–µ—Ç</span>
                            </div>
                            <div class="cargo-type-column" data-type="american-pallet">
                                <div class="cargo-image-placeholder">
                                    <img src="–ø–∞–ª–ª–µ—Ç.jpg" alt="–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π –ø–∞–ª–ª–µ—Ç" class="cargo-image">
                                </div>
                                <span>–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π</span>
                            </div>
                            <div class="cargo-type-column" data-type="box">
                                <div class="cargo-icon-mini">üì¶</div>
                                <span>–ö–æ—Ä–æ–±–∫–∞</span>
                            </div>
                            <div class="cargo-type-column" data-type="non-standard">
                                <div class="cargo-icon-mini">üìè</div>
                                <span>–ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç</span>
                            </div>
                        </div>

                        <div class="photo-section-mini">
                            <div class="photo-container-mini" onclick="takePhoto()">
                                <div class="photo-placeholder-mini" id="photoPlaceholder">
                                    <div class="camera-icon-mini">üì∑</div>
                                </div>
                                <img id="cargoPhoto" class="cargo-photo-mini" style="display: none;">
                            </div>
                            <span class="photo-label">–§–æ—Ç–æ</span>
                        </div>
                    </div>

                    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∫–æ–Ω—Ç—Ä–æ–ª—ã -->
                    <div class="right-column">
                        <div class="controls-stack-compact">
                            <div class="control-item-compact">
                                <label>–í–µ—Å</label>
                                <div class="control-buttons-mini">
                                    <input type="number" 
                                           id="weightInput" 
                                           class="control-value-mini weight-input" 
                                           value="1" 
                                           min="1" 
                                           max="10000" 
                                           step="1"
                                           inputmode="numeric"
                                           pattern="[0-9]*"
                                           onchange="updateWeightFromInput()">
                                </div>
                                <span class="control-unit">–∫–≥</span>
                            </div>

                            <div class="control-item-compact">
                                <label>–î–ª–∏–Ω–∞</label>
                                <div class="control-buttons-mini">
                                    <button type="button" class="control-btn-mini minus" onclick="changeDimension('length', -10)">-</button>
                                    <span class="control-value-mini" id="lengthValue">120</span>
                                    <button type="button" class="control-btn-mini plus" onclick="changeDimension('length', 10)">+</button>
                                </div>
                                <span class="control-unit">—Å–º</span>
                            </div>

                            <div class="control-item-compact">
                                <label>–®–∏—Ä–∏–Ω–∞</label>
                                <div class="control-buttons-mini">
                                    <button type="button" class="control-btn-mini minus" onclick="changeDimension('width', -10)">-</button>
                                    <span class="control-value-mini" id="widthValue">80</span>
                                    <button type="button" class="control-btn-mini plus" onclick="changeDimension('width', 10)">+</button>
                                </div>
                                <span class="control-unit">—Å–º</span>
                            </div>

                            <div class="control-item-compact">
                                <label>–í—ã—Å–æ—Ç–∞</label>
                                <div class="control-buttons-mini">
                                    <button type="button" class="control-btn-mini minus" onclick="changeDimension('height', -10)">-</button>
                                    <span class="control-value-mini" id="heightValue">30</span>
                                    <button type="button" class="control-btn-mini plus" onclick="changeDimension('height', 10)">+</button>
                                </div>
                                <span class="control-unit">—Å–º</span>
                            </div>
                        </div>

                        <button class="btn-save-mini" onclick="saveCargo()">
                            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                        </button>

                        <div class="stats-mini">
                            <div class="stat-item clickable-stat" onclick="showCargoListModal()">
                                <span class="stat-label">–ú–µ—Å—Ç–∞:</span>
                                <span class="stat-value" id="cargoCount">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">–ú–∞—Å—Å–∞:</span>
                                <span class="stat-value" id="totalWeight">0 –∫–≥</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">–û–±—ä–µ–º:</span>
                                <span class="stat-value" id="totalVolume">0 –º¬≥</span>
                            </div>
                        </div>

                        <button class="btn-send-mini" onclick="sendToOperator()">
                            üìß –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–ø–∏—Å–∫–∞ –≥—Ä—É–∑–æ–≤ -->
    <div id="cargoListModal" class="modal">
        <div class="modal-content cargo-list-modal-compact">
            <span class="close" onclick="closeCargoListModal()">&times;</span>
            <h3>–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≥—Ä—É–∑—ã</h3>
            <div class="cargo-list-container">
                <div id="cargoListContent" class="cargo-list-content">
                    <!-- –°–ø–∏—Å–æ–∫ –≥—Ä—É–∑–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>
            <div class="modal-totals-compact">
                <div class="total-item-compact">
                    <span class="total-label-compact">–û–±—â–∞—è –º–∞—Å—Å–∞:</span>
                    <span class="total-value-compact" id="modalTotalWeight">0 –∫–≥</span>
                </div>
                <div class="total-item-compact">
                    <span class="total-label-compact">–û–±—â–∏–π –æ–±—ä–µ–º:</span>
                    <span class="total-value-compact" id="modalTotalVolume">0 –º¬≥</span>
                </div>
                <div class="total-item-compact">
                    <span class="total-label-compact">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç:</span>
                    <span class="total-value-compact" id="modalCargoCount">0</span>
                </div>
            </div>
            <div class="cargo-list-actions">
                <button class="btn-secondary" onclick="closeCargoListModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ -->
    <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;">

    <script src="script.js"></script>
    <script>
        // –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞
        document.addEventListener('DOMContentLoaded', function() {
            // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ —ç–∫—Ä–∞–Ω–∞
            function optimizeForScreen() {
                const screenHeight = window.innerHeight;
                const screenWidth = window.innerWidth;
                
                // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –æ—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤
                if (screenHeight < 600) {
                    // –£–º–µ–Ω—å—à–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã
                    document.querySelector('.app-container').style.padding = '3px';
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º –≤—ã—Å–æ—Ç—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                    const cargoTypes = document.querySelectorAll('.cargo-type-column');
                    cargoTypes.forEach(el => {
                        el.style.padding = '4px 3px';
                        el.style.minHeight = '32px';
                    });
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º —Ñ–æ—Ç–æ
                    document.querySelector('.photo-container-mini').style.width = '35px';
                    document.querySelector('.photo-container-mini').style.height = '35px';
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º –∫–Ω–æ–ø–∫–∏
                    document.querySelectorAll('.btn-save-mini, .btn-send-mini').forEach(btn => {
                        btn.style.padding = '8px';
                        btn.style.fontSize = '11px';
                    });
                }
                
                // –î–ª—è —É–∑–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤
                if (screenWidth < 350) {
                    // –î–µ–ª–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–∂–µ
                    document.querySelectorAll('.control-item-compact').forEach(el => {
                        el.style.padding = '4px';
                    });
                    
                    // –£–º–µ–Ω—å—à–∞–µ–º —Ç–µ–∫—Å—Ç –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
                    document.querySelectorAll('.stat-label, .stat-value').forEach(el => {
                        el.style.fontSize = '10px';
                    });
                }
            }
            
            // –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞
            optimizeForScreen();
            window.addEventListener('resize', optimizeForScreen);
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(event) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        });
    </script>
</body>
</html>
